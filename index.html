<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nearby Restaurants</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <h1>Nearby Restaurants</h1>
  <button>FInd near by restaurant</button>
  <div id="results"></div>

  <script>
    // Function to make the API request
    function fetchNearbyRestaurants(latitude, longitude) {
      const options = {
        method: 'GET',
        url: 'https://google-map-places.p.rapidapi.com/maps/api/place/nearbysearch/json',
        params: {
          location: `${latitude},${longitude}`,  // Using dynamic lat/long
          radius: '10000',
          type: 'restaurant',  // Typo fix: 'restaurant' instead of 'restraunts'
          language: 'en',
          opennow: 'true',
          rankby: 'prominence'
        },
        headers: {
          'x-rapidapi-host': 'google-map-places.p.rapidapi.com',
          'x-rapidapi-key': '2d976a9e74mshe0117e413d61c93p19f005jsna9065aa66056'
        }
      };

      axios.request(options)
        .then(function (response) {
          console.log(response.data); // Log the data to the console
          displayResults(response.data); // Call the function to display the results
        })
        .catch(function (error) {
          console.error(error);
        });
    }

    // Function to display the results on the page
    function displayResults(data) {
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = ''; // Clear previous results
      if (data.results && data.results.length > 0) {
        data.results.forEach((place) => {
          const placeElement = document.createElement('div');
          placeElement.innerHTML = `<h2>${place.name}</h2><p>Address: ${place.vicinity}</p>`;
          resultsDiv.appendChild(placeElement);
        });
      } else {
        resultsDiv.innerHTML = '<p>No restaurants found nearby.</p>';
      }
    }

    // Get user's location using Geolocation API
    function getUserLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          function (position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            console.log(`Latitude: ${latitude}, Longitude: ${longitude}`);
            // Call the API with the fetched location
            fetchNearbyRestaurants(latitude, longitude);
          },
          function (error) {
            console.error('Error fetching location: ', error);
            document.getElementById('results').innerHTML = '<p>Could not get your location.</p>';
          }
        );
      } else {
        alert('Geolocation is not supported by this browser.');
      }
    }

  document.getElementsByTagName('button').onclick(){
    getUserLocation();
  }
  </script>
</body>
</html>
